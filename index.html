
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=.75, shrink-to-fit=yes">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<script src="lib/jquery.ui.touch-punch.min.js"></script>
	<link REL="SHORTCUT ICON" HREF="img/favicon.ico">
	<title>tè2té</title>
</head>
<style>
	:root 		{ 	--mobileOff:0px; }
	body 		{ 	font-family:Verdana,Geneva,sans-serif; font-size:10px; padding:0px; margin:0px; box-sizing:content-box; }
	.co-splash 	{ 	position:absolute;width:100%; color:#999; text-align:center; margin-top:15%;  display:none; }
	.co-top		{	opacity:0; overflow:hidden;height:calc(100vh - var(--mobileOff)); }
	.co-venue 	{	display:grid; grid-template-columns: 25% 50% 25%;  
					font-size: 30px; text-align:center; height:100%;
					text-shadow:2px 2px 3px #8a7a56; border-radius:8px; color:#fff; 
					user-select:none; -webkit-user-select:none; -ms-user-select:none; }
	.co-room 	{	background-image:url("img/carpet3.jpg"); background-repeat:repeat; border: 3px solid #000; }
	.co-join	{	position:absolute;left:calc(50% - 30px); width:60px; top:calc(100% - 26px);cursor:pointer; font-size:14px; 
					border:0px solid #fff; border-radius:12px; background-color:#2d6ab3; padding-bottom:1px; }
	.co-roomTitle {	font-size:18px; margin:32px; color:#000; pointer-events:none; text-shadow:2px 2px 6px #aaa}
 	.co-me 		{	position:absolute;  cursor:url(img/move.cur),auto; left:50%; top:50%; border-radius:64px; }
	.co-queue 	{	color:#fff; text-align:center; font-size:9px; border-radius:16px; background-color:#ff0000;
					border:1px solid; white; cursor:pointer; margin:-14px 0 0 50px; width:12px; height:12px; display:none; }
	.co-avatar 	{	position:absolute; cursor:pointer; left:50%; top:50%; background-color:#fff; border-radius:64px; }
	.co-card 	{	position:absolute; width:300px; height:150px; background-color:#fff; border-radius:8px;
					border:1px solid #666; padding:24px; text-align:center; font-size:14px; box-shadow:3px 3px 6px #666}
	.co-qlist 	{	position:absolute; width:250px; height:300px; background-color:#fff; border-radius:8px;
					border:1px solid #666; padding:12px; text-align:center; font-size:12px; box-shadow:3px 3px 6px #666}
	.co-chat	{	position:absolute; width:250px; height:320px; background-color:#fff; border-radius:16px;
					border:1px solid #666; padding:24px; text-align:center; font-size:14px; box-shadow:3px 3px 6px #666}
	.co-textS 	{	background-color:#ddd; border-radius:16px; padding:2px 8px; width:fit-content; max-width: 66%; margin:5px 0; clear:both; }
	.co-textR 	{	background-color:#0099ff; border-radius:16px; padding: 2px 8px; width:fit-content; max-width: 66%;  margin:5px 0; float:right; color:#fff;	}
	.co-video	{	position:absolute; background-color:#fff; border-radius:4px; width:40%;
					border:1px solid #666; padding:8x; box-shadow:3px 3px 6px #666}
	.co-is 		{	border-radius:16px; padding:0 8px; width:250px; height: 24px; border:1px solid #999; font-size: 13px; }

	body ::-webkit-scrollbar { width: 9px; height:8px } 
	body ::-webkit-scrollbar-track { background: transparent; }
	body ::-webkit-scrollbar-thumb { border-radius:8px ;background:#a4baec }
	body ::-webkit-scrollbar-thumb:hover { background: #a4baec }

</style>
<body>

<script>

if ((location.protocol != 'https:') && (window.location.host != "localhost")) location.href = 'https:' + window.location.href.substring(window.location.protocol.length); // FORCE HTTPS!
var app=null;																						// Holds app

	$(window).resize(function() { if (app) app.Draw();	  })                                      // ON WINDOW RESIZE

	$(document).ready(function() {								           						// ON PAGE LOADED
		isMobile=navigator.userAgent.match(/(ipad|iphone|ipod|android)/i) ? true : false;			// Set mobile flag
		if (isMobile)	document.documentElement.style.setProperty("--mobileOff","100px");			// Set CSS var
		var url=window.location.search.substring(1);						   						// Get query string
		app=new App("meeting1", url);                                                    			// Alloc app
		if (window.location.host != "localhost")  {													// Not in debug 
			$("#splashDiv").fadeIn().delay(3000).fadeOut();											// Fade out splash
			$("#co-top").delay(3400).animate({opacity:1},1000);										// Wait, and fade in main
			}	
		else $("#co-top").css("opacity",1);															// Load fast

		$(window).on("keydown",function(e) {														// HANDLE KEYPRESS
			if ((e.which == 84) && e.altKey && e.ctrlKey)	{										// Test key (Ctrl+Alt+T)
				let i=Math.floor(Math.random()*app.people.length);									// Set queue number	
				app.queue.push({ id:i, msg:"Got a minute to talk?" });
				$("#co-queue").text(app.queue.length); 	$("#co-queue").show();	
				Sound("ding");																		// Ring the bell
				}
			});
	});	
 
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// APP
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

class App  {																					

	constructor(meetingId, myId)   																// CONSTRUCTOR
	{
		app=this;																					// App global pointer
		this.scale=1;																				// Scale
		this.meetingId="";																			// Meeting id
		this.myId=Math.floor(Math.random()*1000);													// My unique id
		this.venue="";																				// Venue frame
		this.people=[];																				// Holds attendees
		this.rooms=[];																				// Holds rooms
		this.schedule="{}";																			// Holds schedule
		this.queue=[];																				// Contact queue
		this.quiet-false;																			// Not in quiet mode
		this.ws=new WebSocket('ws://'+window.location.host+':8080');								// Open websocket											
		this.ws.onmessage=(e)=>{ this.SocketIn(e); };												// ON INCOMING MESSAGE
		this.ws.onopen=()=>    { console.log('connected'); };										// ON OPEN
		this.ws.onclose=()=>   { console.log('disconnected'); };									// ON CLOSE
		this.ws.onerror=(e)=>  { console.log('failed to connect', e); };							// ON ERROR
		this.LoadProject(meetingId);																// Load project																	
		this.Draw();																				// Draw screen
	
		this.n=1;
		setInterval(()=>{
			let i=Math.floor(Math.random()*app.people.length);										// Random person
			let x=Math.floor(Math.random()*70)+26;													// Random x 
			let y=Math.floor(Math.random()*80)+10;													// Random y 
			$("#co-Av-"+i).animate({ left:x+"%", top:y+"%"});										// Animate them there
			++this.n;
			if (!(this.n%6)) {
				$("#co-queue").show();
				this.queue.push({ id:i, msg:"Got a minute to talk?" });
				$("#co-queue").text(app.queue.length); 	$("#co-queue").show();	
				if (app.quiet)	return;
				$("#co-Av-"+i).animate({ left:$("#co-AvMe").css("left"), top:$("#co-AvMe").css("top").replace("px","")-0+62+"px"}
				,400,()=>{Sound("ding"); })															// Ring the bell
				}																					// Ring the bell
			},10000);
		}	

	SocketIn(event)	
	{
		let id=event.data.match(/{(\d*)}/)[1];
		if (id == this.myId)	return;																// No neeed to echo my message out
		let msg=event.data.replace(/{\d*}/,"");														// Strip id out
		if ($("#co-textDiv").length) {																// If chat window is open
			$("#co-textDiv").append("<div class='co-textR'>"+msg+"</div><br>");						// Add message
			$("#co-textDiv").scrollTop(10000);														// Scroll to bottom
			}
		else{
			this.queue.push({ id:5, msg:msg });														// Add to queue
			$("#co-queue").text(app.queue.length); 													// Reset queue dot length
			$("#co-queue").show();																	// Show dor
			}
		Sound("ding");																			// Ring the bell
		trace(id,msg)
	}

	OnMeMove(x, y, targetId)																	// REACT TO MOVING ME AVATAR
	{
		targetId=targetId.replace(/co-AvMe/,"");													// It's just me
		$("#co-card").remove();																		// Close card if open
		$("#co-chat").remove();																		// Close chat if open
		$("#co-sched").remove();																		// Remove old one
		let px=$("#co-main").offset();																// Offset of main div
	
		if (targetId.match(/co-Jo-/)) {																// Join a room
			let link=this.rooms[targetId.substr(6)].zoom;											// Get zoom link
			if (!link)	return;																		// Quit if no link set
			let myWin=window.open(link,"_blank","height=100,width=100,scrollbars=no,toolbar=no,status=no,menubar=no");	// Open zoom link
			setTimeout(function(){ myWin.close(); },10000);											// Close after 10 secs
			this.quiet=false;																		// Not in quiet mode
			}
		if (targetId.match(/co-Rm-/)) {																// In a room
			return;																					// Quit
			}
		if (targetId == "co-search") {																// ON SEARCH BUTTON
			return;																					// Quit
			}
		if (targetId == "co-schedule") {															// ON SCHEDULE BUTTON
			this.ShowSchedule();																	// Show schedule
			return;																					// Quit
			}
		else if (targetId.match(/co-Av-/)) {														// ON A PERSON
			x=$("#"+targetId).css("left").replace("px","")-4+px.left;								// Position directly over X
			y=$("#"+targetId).css("top").replace("px","")-4+px.top;									// Y
			this.ShowCard(x,y,targetId);															// Show card
			return;																					// Quit
			}
		else if (targetId.match(/co-quiet/)) {														// ON QUIET AREA
			x=$("#co-hall").position().left-px.left+$("#co-quiet").width()/2-8;						// Center x
			y=$("#co-hall").height()-100-px.top;													// On top
			this.quiet=true;																		// In quite mode
			this.ReportPosition(0,0,"quiet");														// Report
			}
		else if (targetId.match(/co-coffee/)) {														// ON COFFEE BAR
			x=$("#co-hall").position().left-px.left-$("#co-coffee").width()/2+$("#co-hall").width()-38;// Center x
			y=$("#co-hall").height()-100-px.top;													// On top
			this.quiet=false;																		// Not in quiet mode
			}
		else this.quiet=false;																		// Not in quiet mode
		$("#co-AvMe").animate({ left:x-0+px.left, top:y-0+px.top});									// Animate me there
		this.ReportPosition(x/$("body").width(),x/$("body").height(),targetId.substr(3));			// Report my move
	}

	ReportPosition(x, y, id)
	{
//		trace(x, y,id)
	}
	
	Draw() 																						// REDRAW
	{
		let bx=$("body").width(), by=$("body").height();											// Body size
		let x=bx*this.scale, y=by*this.scale;														// Max
		$("#co-main").width(x);		$("#co-main").height(y);										// Scale div
		$(("#co-main")).draggable("option", "containment", [ bx-x,by-y,0,0 ]);						// Set containment
		let p=$("#co-main").offset();																// Get offset
		$("#co-main").css({ left:Math.max(bx-x,p.left), top:Math.max(by-y,p.top) });				// Cap to max
		}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// CARDS
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	ShowQueue(x, y)																				// SHOW QUEUE DOT
	{
		let i;
		$("#co-chat").remove();																		// Close chat if open
		$("#co-card").remove();																		// Close card if open
		$("#co-sched").remove();																		// Remove old one
		if (!this.queue.length)	return;																// Nothing to show
		
		let str=`<div id='co-card' class='co-qlist' style='left:${x-119}px;top:${y+59}px'>
			<b style='font-size:18px'>Messages</b><hr><br>
			<div style="overflow-x:hidden;overflow-y:auto;height:calc(100% - 50px)">`;
			for (i=0;i<this.queue.length;++i) {
				str+=`<div id="co-qv-${i}" style="vertical-align:top">
				<div style="float:left;text-align:left;width:100%">
					<img id="co-qi-${i}" style="float:left;width:40px;margin: -4px 8px 8px 4px" src="av${this.queue[i].id}.png">
					<b>${this.people[this.queue[i].id].name}</b></br>
					<i>${this.queue[i].msg}</i>
					<img src="img/deletebut.png" id="co-qd-${i}" style="float:right;cursor:pointer;margin:-8px 8px 0 0"></div></div>`
				}
			str+="</div>"
			str+=`<div style="position:absolute;left:139px; top:-10px; width:0;height:0; 
				transform:rotate(180deg); border-style:solid; border-width: 14px 8px 0 8px;
    			border-color: #fff transparent transparent transparent"></div>
			</div>`;
		$("body").append(str.replace(/\t|\n|\r/g,""));
	
		$("[id^=co-qd-]").on("click",(e)=>{															// ON DELETE CLICK
			let i=e.target.id.substr(6)-0;															// Get index
			let targetId="co-Av-"+i;																// Recreate id
			$("#co-qv-"+i).remove();																// Kill it
			this.queue.splice(i,1);																	// Remove it
			Sound("delete");																		// Delete sound
			if (this.queue.length) 	$("#co-queue").text(this.queue.length);							// Update count
			else 		$("#co-queue").hide();														// Remove	
			this.ShowQueue(x,y);																	// Reshow
//			ReportChange("queue", id)
			});

		$("[id^=co-qv-]").on("click",(e)=>{															// ON AVATAR CLICK
			let id=e.target.id.substr(6)-0;															// Get id
			let targetId="co-Av-"+this.queue[id].id;												// Recreate id
			let x=$("#"+targetId).css("left").replace("px","")-4;									// Position directly over X
			let y=$("#"+targetId).css("top").replace("px","")-4;									// Y
			this.ShowCard(x,y,targetId);															// Show card
			});
	}

	ShowCard(x, y, id)
	{
		$("#co-card").remove();
		$("#co-chat").remove();																		// Close chat if open
		$("#co-sched").remove();																		// Remove old one
		y=y-0;
		let flip=false, y2=y;
		if (y < 340) flip=true,y2=y+283;															// Flip to bottom

		let o=this.people[id.substr(6)-0];															// Point at person
		let str=`<div id='co-card' class='co-card' style='left:${x-140}px;top:${y2-208}px'>
			<b style='font-size:24px'>${o.name}</b><br><br>
			<b>${o.role}<br>${o.org}</b><br><br>Interests: ${o.ints}<br>
			<p style="position:absolute;left:24px;bottom:0">`;
			if (o.li) str+=`<a href="https://linkedin.com/in/${o.li}" target="_blank">
				<img style="cursor:pointer"src="img/LI-Logo.png" height="14px"></a>`;
			str+=`</p><button id="co-chatBut" style="position:absolute; left:225px; bottom:14px; cursor:pointer;
				border-radius:20px; width:100px; background-color:#2d6ab3; color:#fff">
				Chat now!</button> &nbsp;&nbsp
				<div style="position:absolute;left:165px; top:${flip ? "-10" : "195"}px; width:0;height:0; 
				${flip ? "transform: rotate(180deg)" : ""};
				border-style:solid; border-width: 14px 8px 0 8px;
    			border-color: #fff transparent transparent transparent;"></div>
			</div>`;
		$("body").append(str.replace(/\t|\n|\r/g,""));
		$("#co-chatBut").on("click",()=>{ this.Chat(x,y,id,flip)} )
	}

	Chat(x, y, id, flip)																		// CHAT CLIENT
	{
		$("#co-card").remove();																		// Remove old one
		$("#co-chat").remove();																		// Remove old one
		$("#co-sched").remove();																	// Remove old one
		$("#co-AvMe").animate({ left:x+4, top:y+68});												// Animate me there
		this.ReportPosition(x/$("body").width(),x/$("body").height(),id.substr(6));					// Report my move
		let y2=y;
		if (flip) y2=y+519;
		let str=`<div id='co-chat' class='co-chat' style='left:${x-118}px;top:${y2-382}px'>
			<b>Chat with ${this.people[id.substr(6)].name}</b><hr>
			<button id="co-zoomBut"  style="cursor:pointer; border-radius:20px; background-color:#2d6ab3; color:#fff">Ask to video chat</button>
			<div id="co-textDiv" style="height:235px;overflow-x:hidden;overflow-y:auto;margin-top:8px;border:1px solid #999;border-radius:6px;padding:0 4px"></div>														
			<div style="position:absolute;top:330px;left:24px">
				<input  id="revText" placeholder="Type here..." class='co-is' style='width:202px'>			
				<img id='revTextBut'src='img/sendtext.png' style='vertical-align:-7px;margin-left:5px;cursor:pointer'>
				</div>	
			<div style="position:absolute;left:144px; top:${flip ? "-10" : "368"}px; width:0;height:0; 
				${flip ? "transform: rotate(180deg)" : ""};
				border-style:solid; border-width: 14px 8px 0 8px;
    			border-color: #fff transparent transparent transparent;"></div>
			</div>`;
		$("body").append(str.replace(/\t|\n|\r/g,""));												// Add chatbox

		$("#revText").on("change",   function(e) { chatWith();	});									// On text enter
		$("#revTextBut").on("click", function(e) { chatWith();	});									// On text button click
		$("#co-zoomBut").on("click", ()=>{															// On Zoom button click
			$("#co-textDiv").append("<div class='co-textS'>Want to video chat?</div>");				// Ask to video chat
			$("#co-textDiv").scrollTop(10000);														// Scroll to bottom
			});

		function chatWith() {																		// TEXT CHATTING
			var s=$("#revText").val();																// Get text
			if (s) {																				// If something there
				$("#co-textDiv").append("<div class='co-textS'>"+s+"</div>");						// Add to display 
				if (app.ws)	app.ws.send("{"+app.myId+"}"+s);										// Send message
				$("#co-textDiv").scrollTop(10000);													// Scroll to bottom
				}
			$("#revText").val("");																	// Clear input
			}	
		}
	
	ShowHelp() 																					// SHOW HELP
	{
		return;
		if ($("#helpDiv").length) {																// If already up, bring it down
			$("#helpDiv").hide("slide",{ direction:"down", complete: ()=>{ $("#helpDiv").remove(); } }); // Slide down
			return;																				// Quit																					
			}
		var h=window.innerHeight;
		var str="<div id='helpDiv' class='lz-dialog'style='height:"+(h-106)+"px;overflow:hidden;display:none;;left:calc(100vw - 646px)'>";
		str+="<img src='img/lizalogo.png' style='vertical-align:-6px' width='64'><span style='font-size:18px;margin-left:8px'>"
		str+="help</span><img src='img/closedot.gif' style='float:right' onclick='$(\"#helpDiv\").remove()'><br><br>";	
		str+="<iframe src='https://docs.google.com/document/d/e/2PACX-1vTXAsMJ-YlQaNtT49RtKvEnT5v5Xzz-TKPyVlo2px-23vDt-4lZFB7JujSKyDXs38hiSMISQoulYXB5/pub?embedded=true' ";
		str+="style='border: 1px solid #999;width:100%;height:"+(h-154)+"px' scrolling='yes'></iframe></div>";
		$("body").append(str);																	// Add to body
		$("#helpDiv").show("slide",{ direction:"down" });										// Slide up
		if (!isMobile)	$("#helpDiv").draggable();												// Make it draggable on desktop
	}

	ShowSchedule()																			// SHOW EVENT SCHEDULE
	{
		$("#co-sched").remove(); 
		let b=$("#co-schedule").offset();
		let str=`<div id="co-sched" class="co-card"' style="top:12px; display:none;
			left:${$("#co-hall").offset().left+12}px;
			width:${$("#co-hall").width()-68}px; height:${b.top-80}px">
			<b style="'font-size:30px">Event schedule</b><hr><br>
				<br>Events listed here, along with button to add them to attendee's personal schedule.
			</div>`;
		$("body").append(str.replace(/\t|\n|\r/g,""));												// Add schedule
		$("#co-sched").show("slide",{ direction:"down" });										// Slide up
	}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// DATA
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	LoadProject(meetingId)																			// LOAD PROJECT DATA
	{
		let i,o;
		this.meetingId=meetingId;																	// Project id
		this.people=[ 
			{ name:"Kendra Grinnage", role:"Manager", email:"1", ints:"Machine learning, dogs", org:"Kennedy & Company", li:"kendra-grinnage-13062b17",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}, 
			{ name:"Mark Schubin", role:"Engineer and explainer", email:"2", ints:"Video, technology", org:"Schubin Cafe", li:"mark-schubin",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}, 
			{ name:"Nancy Drew", role:"Detective", email:"3", ints:"Difficult crimes, lemonade", org:"Drew Detective Agency", li:"",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}, 
			{ name:"Johnny Quest", role:"Adventurer", email:"4", ints:"India, helpful people", org:"Warner Brothers", li:"",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}, 
			{ name:"Nathaniel Grove", role:"Research scientist", email:"5", ints:"Tibet, technology", org:"University of Virginia", li:"than-grove-61a29519",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}, 
			{ name:"Bill Ferster", role:"Founder", email:"6", ints:"Technology, education, farm-work", org:"StageTools", li:"bferster",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}, 
			{ name:"Robert Berry", role:"Professor", email:"7", ints:"Mathematics, technology, education", org:"University of Virginia", li:"robert-berry-23511712",zoom:"https://zoom.us/j/5232205750?pwd=ZG9UMllEVS93ZlkyQ3RCNzRteFY3Zz09"}
			]; 
			
		$.ajax({ url:"//"+window.location.host+":8001/"+meetingId+"/people/", dataType:'jsonp', }).fail((msg)=> { console.log(msg); });													// Failure message

		let hallway=`<table style="position:absolute;top:calc(100% - 105px);width:50%;padding:0 12px;height:100px"><tr style="vertical-align:bottom">
				<td style="text-align:left;width:33%"><img src="img/quietarea.png" id="co-quiet" style="width:50%"></td>
				<td style="text-align:center;width:33%">`;
		if (this.schedule)	hallway+=`<img src="img/schedule2.png" id="co-schedule" style="width:12.5%;cursor:pointer">&nbsp;&nbsp;`
		hallway+=`<img src="img/search.png" id="co-search" style="width:12.5%;cursor:pointer"></td>
				<td style="text-align:right;width:33%"><img id="co-coffee" src="img/coffeebar.png" style="width:50%"></td>
				</tr></table>`;

		this.rooms=[
			{ zoom:"", title:"<img src='site.png'>", cs:2, ce:2, rs:1, re:5, content:hallway  },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Main room", cs:1, ce:1, rs:1, re:3,
				content:`<div style="font-size:18px;background-color:#42b97a;color:#fff;margin:24px;padding:12px;border:2px solid #fff;border-radius:8px;pointer-events:none; ">
				Please join SITE president<br><b>Elizabeth Langren</b><br><br>
				<img src="liz.jpg" style="width:33%;border:2px solid #fff;border-radius:300px"><br>
				for the keynote speech<br> in <b></b>15</b></15> minutes</div>` },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Room A", cs:1, ce:1, rs:3, re:3,
				 content:`<div class="co-roomTitle"><b>The Flipped Classroom</b><br>Glen Bull</div>` },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Room B", cs:1, ce:1, rs:4, re:4,
				content:`<div class="co-roomTitle"><b>GIS in the Class</b><br>Thomas Hammond</div>` },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Room C", cs:3, ce:3, rs:1, re:1,
				content:`<div class="co-roomTitle"><b>Graphing Calculators</b></Graphing><br>Joe Garofalo</div>` },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Room D", cs:3, ce:3, rs:2, re:2,
				 content:`<div class="co-roomTitle""><b>Birds of a Feather</b><br>Computer animation</div>` },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Room E", cs:3, ce:3, rs:3, re:3,
				content:`<div class="co-roomTitle"><b>Digital Storytelling</b><br>Bill Ferster</div>` },
			{ zoom:"https://zoom.us/j/98542348220?pwd=N3IzWDNKaGRaT3pXcThOQ21wL1NCQT09", title:"Room F", cs:3, ce:3, rs:4, re:4,
				content:`` }
			];

		this.venue=`<div id="splashDiv" class="co-splash">
			<img src="img/t2logo.png" alt="" style="width:33%"><br><br>
			<p style="color:#000;font-size:14px"><em>A people centered virtual meeting tool</em></p>
			</div>
		<div id="co-top" class="co-top"><div id="co-main"><div id="co-grid" class="co-venue">`;
		o=this.rooms[0];
		this.venue+=`<div class="co-room" id="co-hall" style="grid-column-start:${o.cs};grid-column-end:${o.ce};grid-row-start:${o.rs};grid-row-end:${o.re}">
		${o.title}${o.content}</div>`;

		for (i=1;i<this.rooms.length;++i) {														// For each room
			o=this.rooms[i];																	// Point at it
			this.venue+=`<div class="co-room" style="grid-column-start:${o.cs};grid-column-end:${o.ce};grid-row-start:${o.rs};grid-row-end:${o.re}">
			<div id="co-Rm-${i}" style="position:relative;height:100%">
			${o.title}${o.content}<div id="co-Jo-${i}" class="co-join">Join!</div></div></div>`;
			}
		this.venue+=`</div>
			<img class="co-avatar" id="co-Av-0" src="av0.png" style="top:20%;left:35%">
			<img class="co-avatar" id="co-Av-1" src="av1.png" style="top:80%;left:45%">
			<img class="co-avatar" id="co-Av-2" src="av2.png" style="top:22%;left:65%">
			<img class="co-avatar" id="co-Av-3" src="av3.png" style="top:70%;left:35%">
			<img class="co-avatar" id="co-Av-4" src="av4.png" style="top:60%;left:60%">
			<img class="co-avatar" id="co-Av-5" src="av5.png" style="top:55%;left:45%">
			<img class="co-avatar" id="co-Av-6" src="av6.png" style="top:85%;left:36%">
			<div class="co-me"     id="co-AvMe"><img src="avme.png"><div id="co-queue" class="co-queue"></div>
		</div>
		<img src="img/help.png"    id="co-help"    style="position:fixed;width:22px;top:calc(100vh - 81px - var(--mobileOff));left:16px;cursor:pointer">
		<img src="img/zoomin.png"  id="co-zoomIn"  style="position:fixed;width:22px;top:calc(100vh - 55px - var(--mobileOff));left:16px;cursor:pointer">
		<img src="img/zoomout.png" id="co-zoomOut" style="position:fixed;width:22px;top:calc(100vh - 34px - var(--mobileOff));left:16px;cursor:pointer">
		</div></div>
		`;
		$("body").html(this.venue.replace(/\t|\n|\r/g,""));										// Create venue
		$("#co-AvMe").draggable();																// Make me draggable
		$("#co-main").draggable();																// Make screen draggable
		$("body").on("wheel", (e)=>{															// ON SCROLL WHEEL
			if (e.originalEvent.deltaY < 0)	this.scale=Math.min(4,this.scale+.5);				// Scale up
			else 							this.scale=Math.max(1,this.scale-.5);				// Scale down
			this.Draw();																		// Redraw
			});
		$("#co-help").on("click",     (e)=>{ this.ShowHelp(); }); 										// ON HELPN
		$("#co-zoomIn").on("click",   (e)=>{ this.scale=Math.min(4,this.scale+.5); this.Draw(); }); 	// ON ZOOM IN
		$("#co-zoomOut").on("click",  (e)=>{ this.scale=Math.max(1,this.scale-.5); this.Draw(); }); 	// ON ZOOM OUT
		$("#co-grid").on("click", 	  (e)=>{ this.OnMeMove(e.pageX-30,e.pageY-30,e.target.id) }); 		// ON GRID CLICK
		$("[id^=co-Av-]").on("click", (e)=>{ this.OnMeMove(e.pageX-30,e.pageY-30,e.target.id) }); 		// ON PERSON CLICK
		$("[id^=co-Jo-]").on("click", (e)=>{ this.OnMeMove(e.pageX-30,e.pageY-70,e.target.id) }); 		// ON JOIN CLICK
		$("[id^=co-Av-]").droppable({ drop:(e)=>{ this.OnMeMove(0,0,e.target.id) }} ); 					// ON DROP ON PERSON
		$("[id^=co-Jo-]").droppable({ drop:(e)=>{ this.OnMeMove(e.pageX-30,e.pageY-70,e.target.id) }}); // ON DROP ON  ROOM
		$("#co-AvMe").on("click", (e)=>{ 																// ON ME CLICK
			let x=$("#co-AvMe").css("left").replace("px","")-0+2;										// CX
			let y=$("#co-AvMe").css("top").replace("px","")-0+10;										// Y
			this.ShowQueue(x,y)
			}); 							
	}


} // APP CLASS CLOSURE

// HELPERS //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	

function PEOPLE(d) { trace(d) }

function trace(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
	}

	function Sound(sound, mute)																		// PLAY SOUND
	{
		var snd=new Audio();																			// Init audio object
		if (sound.match(/\.mp3/i))		snd=new Audio(sound)											// If an MP3 file
		else							snd=new Audio("img/"+sound+".mp3");								// Use built in mp3
		if (!mute)	{																					// If not initing or muting	
			snd.volume=100/100;																			// Set volume
			snd.play();																					// Play it
			}
		}

	function trace2(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		trace(msg);
		$("#co-Rm-0").text(">"+msg+"<")
	}

</script>
</body>
</html>
